# 一个简单的3dTiles数据示例

![image-20200617003657336](E:\Code\my-dev-notes\3dtiles-Notes\tutorial\attachments\image-20200617003657336.png)

上图是一份 3dTiles数据集在文件夹内的样子，层层打开可得以下特点：

- 入口文件是 `tileset.json`
- 各级瓦片用文件夹（目录）来组织

3dTiles 数据目前的具体文件实现，是一些零散的文件。 

数据集的名称与所在文件夹的名称并无关系，数据集的名称写在入口文件中。

3dTiles至少有一个 `tileset.json` 文件，作为整个数据集的入口。它是一个 json 文件，描述了整个三维瓦片数据集，它记录的是上一节提及的“逻辑信息”，还包括一些其他的元数据。而“属性信息”、“嵌入的gltf模型” 则位于各个二进制瓦片文件中，这些二进制文件则由 `tileset.json` 中的瓦片中的 `uri` 来引用。

## 瓦片是什么？

瓦片，屋顶上的瓦片。古时候，盖房子，屋顶不能一次浇筑完工，也没有特定的“屋顶”零件，所以只好一片片瓦片盖上去（我瞎掰的）。

【瓦片图】

瓦片切割了三维数据，允许三维数据进行细分。我们都知道网速是有限的，在加载超大规模的三维模型数据时，不可能把一个模型全部下载下来再渲染，那样等待的时间太慢了，但是一点一点出现，视野范围外的“瓦片”则干脆就不下载、渲染，性能、视觉都有提高。这就是瓦片的设计优点。

传统的二维地图瓦片，叫做 WMTS  或 TMS，这个 "T" 就是 `Tile` 的意思。

现在，你只要知道，3dTiles就是把空间进行切块，每个块叫做 “tile”，也即瓦片。至于怎么切的——待会介绍 tileset.json 时，会隆重介绍树结构。

【二叉树图】

瓦片只有两种情况：叶子瓦片，非叶子瓦片。根瓦片也是非叶子瓦片。非叶子瓦片和叶子瓦片有什么区别呢？主要就是叶子瓦片不会再有孩子了（树结构的知识哈，不懂的建议去学习数据结构中的树）。

瓦片包含什么内容呢？本篇稍微靠后再仔细了解瓦片。

现在，我们先认识一下，描述整个 3dTiles 数据集的入口文件，也叫做三维瓦片数据集 —— tileset.json：

# Tileset——(三维)瓦片数据集

通常，一个三维瓦片数据集（之后简称：一个3dtiles数据）的入口就是那个”tileset.json“，至于这个文件的名称可不可以改，暂时未作测试。

现在，我们先来研究研究 这个入口文件记录了哪些信息，拿一份最简单的 3dtiles数据来举例，该数据只有一个根瓦片（root），根瓦片再无子瓦片。

【tileset.json截图】

root对象中有一个content，内有uri属性，其就记录了根瓦片的二进制数据文件的URL，这个URL是个相对路径，相对于 tileset.json 文件。

## ① 顶级属性概览

asset、root、geometricError（必选）

## ② root瓦片及其children

介绍一下树结构，四叉树，八叉树，格网结构

## ③ 坐标系统

介绍地理坐标系、4979坐标系

# Tile——构成3dtiles的成员：瓦片

通常，瓦片对象会引用一个二进制的瓦片数据文件（也有例外，下文会说，这就是3dTiles的灵活之处）：

【上文复杂一点的tileset.json中取一个 tile 截图】

在1.0 版本的规范中，瓦片所引用的二进制的瓦片数据文件，有四种类型：

- 批量三维模型（Batch 3D Model，文件后缀名b3dm）
- 实例三维模型（Instance 3D Model，文件后缀名i3dm）
- 点云（PointCloud，文件后缀名pnts）
- 复合模型（Component，文件后缀名cmpt）

这些不同的瓦片对应了些什么数据呢？

【表格+四种类型的截图对比】

关于这些二进制瓦片数据文件的数据结构如何，下一篇会详细展开。在这里，上一张各种数据类型的截图和信息对比表：

【ppt里的表格】

现在，我们关注一下，瓦片对象的职能，也就是，它记录了啥信息：

【tile截图】



## 瓦片还可以再引用 3dTiles 数据集！

我一再强调3dTiles十分灵活。

Tile不仅仅可以在其uri属性中引用 诸如 `.b3dm`、`.i3dm`、`.pnts`等二进制瓦片数据文件，还可以再引用一个 3dTiles！

【osgb转换的3dtiles截图】

原则上，只要被引用的子一级3dtiles 不循环引用父级3dtiles，那么就OK（规范如是说）。

它真的很灵活！



---

下一节将展示二进制瓦片文件中的至关重要的一部分：两大数据表。