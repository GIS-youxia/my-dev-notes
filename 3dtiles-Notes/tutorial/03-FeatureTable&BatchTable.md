# 本篇前言

说实话，我很纠结是先介绍瓦片的二进制数据文件结构，还是先介绍这两个重要的表。思前想后，我决定还是先介绍这两个数据表。

因为这两个表不先给读者灌输，那么介绍到瓦片的二进制数据文件结构时，就满嘴“晦涩难懂”啦。

## 数据与模型

上文介绍到，瓦片的三维模型实际上是由gltf承担起来的（作为glb格式嵌入到瓦片二进制文件中），那么，除了模型数据，肯定模型自己本身也有属性数据的。

就比如，门有长宽高、密度、生产日期等信息，楼栋模型有建筑面积、楼层数等信息。

所以，“属性数据” 和 “模型” 是如何产生联系的呢？

【图 属性和模型联系】

再回忆一个重要的 3dTiles 理念：

> 3dTiles 规范本身不包含模型的定义，它仅仅记录模型变成瓦片后的空间组织关系、模型与其属性数据之间的关系。

所以，3dTiles 规范在瓦片二进制数据文件中，使用了两个重要的表来记录这种 ”模型与属性“ 的联系：

- FeatureTable（要素表）
- BatchTable（批量表）

【瓦片结构草图】

这两个表既然存在于二进制瓦片数据文件，是二进制的数据，那就不是传统的二维关系表了，它更多的是一些 键值 信息。

每一种瓦片的这两个表的格式都不一样，但是大致功能是差不多的。

请牢记：

**要素表记录的是整个瓦片的公共数据，批量表更专注于记录每个模型（或每个三维要素）自己的信息。**

**两个表都作为二进制格式存在瓦片文件的前部。**

# 记录公共数据：FeatureTable，要素表

在 b3dm 瓦片中，要素表就会记录这个瓦片有多少个模型单体，这个模型单体在人类逻辑上不可再分。（在某一级别的层次细节中，房子不是单体，构造它的门、门把、窗户、屋顶、墙等才是模型单体）要素表还可能记录当前瓦片的中心坐标，以便gltf使用相对坐标，压缩数据量。

我们以pnts（点云瓦片）举例，它的要素表：



先声明一个“黑话”：

> 在一个瓦片中，一个三维要素（GIS中的通常叫法）= 一个模型（图形学、工业建模叫法） = 一个BATCH（3dtiles叫法）

所以，为什么另外一张表叫 `BatchTable`，而且它记录的是属性数据，我想就很容易想明白了。接下来，介绍记录属性数据的批量表：

# 记录属性数据：BatchTable，批量表







关于两个表的更深一级关系，要等到具体瓦片的介绍篇章，请翻阅后面的篇章。